<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Booking Details - Rent a Car Today!</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .image-placeholder {
            width: 100%;
            height: 300px;
            background-color: #eee;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 20px;
        }
        .status-confirmed {
            color: green;
        }
    </style>
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-light bg-light">
    <div class="container">
        <a class="navbar-brand" href="#">Rent a Car Today!</a>
        <div class="navbar-nav ms-auto">
            <a class="nav-link" href="#">ABOUT US</a>
            <a class="nav-link" href="#" sec:authentication="name">Welcome, User â–¼</a>
        </div>
    </div>
</nav>

<div class="container mt-4">
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="/">Home</a></li>
            <li class="breadcrumb-item"><a href="/customer/my-bookings">My Bookings</a></li>
            <li class="breadcrumb-item active" aria-current="page">Booking Details</li>
        </ol>
    </nav>

    <h2>Booking Details</h2>

    <div class="row">
        <div class="col-md-6">
            <div class="image-placeholder">
                Car Image Placeholder
            </div>
        </div>
        <div class="col-md-6">
            <div class="booking-info">
                <h3 th:text="${booking.carBookings[0].car.brand + ' ' + booking.carBookings[0].car.model + ' ' + booking.carBookings[0].car.productionYears.getYear()}">Car Brand Model Year</h3>
                <p th:text="'From: ' + ${#dates.format(booking.startDateTime, 'dd/MM/yyyy - HH:mm')}"></p>
                <p th:text="'To: ' + ${#dates.format(booking.endDateTime, 'dd/MM/yyyy - HH:mm')}"></p>
                <p th:text="'Number of days: ' + ${T(java.time.temporal.ChronoUnit).DAYS.between(booking.startDateTime.toInstant(), booking.endDateTime.toInstant())}"></p>
                <p th:text="'Base price: $' + ${booking.carBookings[0].car.basicPrice}"></p>
                <p th:text="'Total: $' + ${booking.carBookings[0].car.basicPrice * T(java.time.temporal.ChronoUnit).DAYS.between(booking.startDateTime.toInstant(), booking.endDateTime.toInstant())}"></p>
                <p th:text="'Deposit: $' + ${booking.carBookings[0].car.deposit}"></p>
                <p th:text="'Booking No.: ' + ${booking.bookingNo}"></p>
                <p>Booking status: <span th:text="${booking.status}" th:class="${'status-' + #strings.toLowerCase(booking.status)}"></span></p>
            </div>

            <div class="mt-3">
                <a th:href="@{/customer/my-bookings/{id}(id=${booking.id})}" class="btn btn-primary">View Details</a>
                <form th:action="@{/customer/my-bookings/{id}/confirm-pickup(id=${booking.id})}" method="post" style="display: inline;" onsubmit="return confirmPickup()">
                    <button type="submit" class="btn btn-secondary" th:if="${booking.status == 'Confirmed'}">Confirm Pickup</button>
                </form>
                <form th:action="@{/customer/my-bookings/{id}/cancel(id=${booking.id})}" method="post" style="display: inline;" onsubmit="return confirmCancel()">
                    <button type="submit" class="btn btn-danger" th:if="${booking.status != 'Cancelled' && booking.status != 'Completed'}">Cancel Booking</button>
                </form>
            </div>

            <script>
                function confirmPickup() {
                    return confirm("Are you sure you want to confirm pick-up?");
                }

                function confirmCancel() {
                    return confirm("Are you sure you want to cancel this booking?");
                }
            </script>

        </div>
    </div>

    <ul class="nav nav-tabs mt-4" id="myTab" role="tablist">
        <li class="nav-item" role="presentation">
            <button class="nav-link active" id="booking-tab" data-bs-toggle="tab" data-bs-target="#booking" type="button" role="tab" aria-controls="booking" aria-selected="true">Booking Information</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="car-tab" data-bs-toggle="tab" data-bs-target="#car" type="button" role="tab" aria-controls="car" aria-selected="false">Car Information</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="payment-tab" data-bs-toggle="tab" data-bs-target="#payment" type="button" role="tab" aria-controls="payment" aria-selected="false">Payment Information</button>
        </li>
    </ul>

    <div class="tab-content mt-4" id="myTabContent">
        <div class="tab-pane fade show active" id="booking" role="tabpanel" aria-labelledby="booking-tab">
            <h4>Renter's Information</h4>
            <form th:action="@{'/customer/my-bookings/' + ${booking.id} + '/update-renter-infor'}" method="post">
            <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="name" class="form-label">Full Name:</label>
                        <input type="text" class="form-control" id="name" name="name" th:value="${customer.name}" required>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="dateOfBirth" class="form-label">Date of Birth:</label>
                        <input type="date" class="form-control" id="dateOfBirth" name="dateOfBirth" th:value="${#dates.format(customer.dateOfBirth, 'yyyy-MM-dd')}" required>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="phoneNo" class="form-label">Phone Number:</label>
                        <input type="tel" class="form-control" id="phoneNo" name="phoneNo" th:value="${customer.phoneNo}" required>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="email" class="form-label">Email Address:</label>
                        <input type="email" class="form-control" id="email" name="email" th:value="${customer.email}" required>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="nationalIdNo" class="form-label">National ID No.:</label>
                        <input type="text" class="form-control" id="nationalIdNo" name="nationalIdNo" th:value="${customer.nationalIdNo}" required>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="drivingLicense" class="form-label">Driving License:</label>
                        <input type="text" class="form-control" id="drivingLicense" name="drivingLicense" th:value="${customer.drivingLicense}" required>
                    </div>
                </div>
                <div class="mb-3">
                    <label for="address" class="form-label">Address:</label>
                    <input type="text" class="form-control" id="address" name="address" th:value="${customer.address}" required>
                </div>
                <button type="submit" class="btn btn-primary">Update Information</button>
            </form>
        </div>


        <div class="tab-pane fade" id="car" role="tabpanel" aria-labelledby="car-tab">
            <div class="mt-4">
                <h4>Car Information</h4>
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="licensePlate" class="form-label">License Plate:</label>
                        <input type="text" class="form-control" id="licensePlate" value="ABC-1234" disabled>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="brand" class="form-label">Brand:</label>
                        <input type="text" class="form-control" id="brand" value="Nissan" disabled>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="model" class="form-label">Model:</label>
                        <input type="text" class="form-control" id="model" value="Navara" disabled>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="color" class="form-label">Color:</label>
                        <input type="text" class="form-control" id="color" value="Black" disabled>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="numberOfSeats" class="form-label">Number of Seats:</label>
                        <input type="number" class="form-control" id="numberOfSeats" value="5" disabled>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="productionYear" class="form-label">Production Year:</label>
                        <input type="number" class="form-control" id="productionYear" value="2017" disabled>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="transmissionType" class="form-label">Transmission Type:</label>
                        <input type="text" class="form-control" id="transmissionType" value="Automatic" disabled>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="fuelType" class="form-label">Fuel Type:</label>
                        <input type="text" class="form-control" id="fuelType" value="Diesel" disabled>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="mileage" class="form-label">Mileage:</label>
                        <input type="number" class="form-control" id="mileage" value="25000" disabled>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="fuelConsumption" class="form-label">Fuel Consumption:</label>
                        <input type="text" class="form-control" id="fuelConsumption" value="10 km/l" disabled>
                    </div>
                </div>
                <div class="mb-3">
                    <label for="description" class="form-label">Description:</label>
                    <textarea class="form-control" id="description" rows="3" disabled>Spacious and powerful, perfect for long trips and off-road adventures.</textarea>
                </div>
            </div>
        </div>
        <div class="tab-pane fade" id="payment" role="tabpanel" aria-labelledby="payment-tab">
            <!-- Payment Information Tab Content -->
            <p>No payment details available.</p>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
